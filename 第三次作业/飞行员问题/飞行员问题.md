
# 最优飞行计划

## 背景
​	在甲乙双方的一场战争中,一部分甲方部队被乙方部队包围长达4个月。由于乙方封锁了所有水陆交通通道,被包围的甲方部队只能依靠空中交通维持供给。运送4个月的供给分别需要2次,3次,3次,4次飞行。每次飞行编队由50架飞机组成(每架飞机需要3名飞行员),可以运送$10^5t​$物资。每架飞机每个月只能飞行一次,每名飞行员每个月也只能飞行一次。在执行完成运输任务后的返回途有20%的飞机会被乙方部队击落,相应的飞行员也因此牺牲或失踪。在第1个月开始时,甲方拥有110架飞机和330名熟练的飞行员。在每个月开始时,甲方可以招聘新飞行员和购买新飞机。新飞机必须经过一个月的检査后オ可以投入使用,新飞行员必须在熟练飞行员的指导下经过一个月的训练才能投入飞行。只有不执行当月飞行任务的熟练飞行员可以作为当月的教练指导新飞行员进行训练。每名熟练飞行员可以作为教练每个月指导20名飞行员(包括他自己在内)进行训练。每名飞行员在完成一个月的飞行任务后,必须有一个月的带薪假期,假期结束后才能再投入飞行。已知各项费用(单位略去)如下表所示,请你为甲方安排一个飞行计划。


|          报酬名称          | 第一个月 | 第二个月 | 第三个月 | 第四个月 |
| :------------------------: | :------: | :------: | :------: | :------: |
|         新飞机价格         |   200    |   195    |   190    |   185    |
|    闲置的熟练飞行员报酬    |    7     |   6.9    |   6.8    |   6.7    |
| 教练及飞行员报酬和训练费用 |    10    |   9.9    |   9.8    |   9.7    |
|  执行飞行任务的飞行员报酬  |    9     |   8.9    |   9.8    |   9.7    |
|     休假期的飞行员报酬     |    5     |   4.9    |   4.8    |   4.7    |

<div style="page-break-after:always;"> </div>


## 问题摘要
1. 飞行基地需要进行四个月飞行，次数分别为2次,3次,3次,4次。
2. 每次飞行由50架飞机组成，每架飞机需要3名飞行员。
3. 每个飞机与每名飞行员一个月只能飞行一次
4. 飞行员完成一个月的飞行后必须休息一个月
5. 飞行结束有20%的概率同时失去一名飞行员与一架飞机
6. 每月初可以招聘飞行员、购买新飞机
7. 购买的新飞机一个月后才能开始启用
8. 新飞行员必须在熟练飞行员指导下一个月才能飞行
9. 每个月不参与飞行的教练可以指导20名飞行员(包括他自己在内)进行训练

初始条件：在第1个月开始时,甲方拥有110架飞机和330名熟练的飞行员




## 问题分析

|          报酬名称          | 第一个月 | 第二个月 | 第三个月 | 第四个月 |
| :------------------------: | :------: | :------: | :------: | :------: |
|         新飞机价格         |   200    |   195    |   190    |   185    |
|    闲置的熟练飞行员报酬    |    7     |   6.9    |   6.8    |   6.7    |
| 教练及飞行员报酬和训练费用 |    10    |   9.9    |   9.8    |   9.7    |
|  执行飞行任务的飞行员报酬  |    9     |   8.9    |   9.8    |   9.7    |
|     休假期的飞行员报酬     |    5     |   4.9    |   4.8    |   4.7    |

要在完成飞行任务的前提下使飞行员所花费的总价格最少，新飞行员必须在熟练飞行员指导下训练一个月后能投入飞行，所以在第四个月就没有购买新飞机和训练新飞行员的必要了，表格中也只有前三个月的购买情况。$x_n$表示第$n$个月购买新飞机的数量，$y_n$表示第$n​$个月安排教练的数量


<div style="page-break-after:always;"></div>


## 模型假设与分析

### 对于问题一，购买新飞机数和教练的安排数量进行如下假设:

| 月份 | 购买新飞机数 | 安排教练 |
| ---- | ------------ | -------- |
| 1    | $x_1$        | $y_1$    |
| 2    | $x_2$        | $y_2$    |
| 3    | $x_3$        | $y_3$    |

从第二个月后开始，后一个月可以使用的飞机数量为前一个月所剩余的飞机数和新购买的飞机数之和，而后一个月可用的飞行员为前一个月闲置飞行员，新飞行员，带薪休假飞行员的数量之和。根据题意与以上假设，我们有一下四个月的分析:


#### 第一个月的情况，
$$
\begin{align}
可用飞机数:&\quad 110\\
\\
可用飞行员数:&\quad 330\\
\\
带薪休假人数:&\quad 0\\
\\
闲置飞行员人数:&\quad 30-y_1\\

\end{align}
$$



#### 第二个月的情况，
$$
\begin{align}
可用飞机数:&\quad 90+x_1\geq 150\\
\\
可用飞行员数:&\quad 30+19y_1\geq 450\\
\\
带薪休假人数:&\quad 240\\
\\
闲置飞行员人数:&\quad 19y_1-y_2-420\\

\end{align}
$$

<div style="page-break-after:always;"></div>

#### 第三个月的情况，
$$
\begin{align}
可用飞机数:&\quad x_1+x_2+60\geq150\\
\\
可用飞行员数:&\quad 19y_1+19y_2-180\geq450\\
\\
带薪休假人数:&\quad  360\\
\\
闲置飞行员人数:&\quad 19y_1+19y_2-y_3-630\\

\end{align}
$$

#### 第四个月的情况，
$$
\begin{align}
可用飞机数:&\quad x_1+x_2+x_3+30\geq 200\\
\\
可用飞行员数:&\quad 19y_1+19y_2+19y_3-270\geq600\\
\\
带薪休假人数:&\quad  360\\
\\
闲置飞行员人数:&\quad 19y_1+19y_2+19y_3-630\\

\end{align}
$$
计算后得出的最后的支出为


$$
Cost=min(200x_1+580.6y_1+195x_2+447.6y_2+190x_3+316.5y_3+8730)
$$



针对以上约束条件，我们使用`lingo`软件进行求解

```lisp
min=200*x1+580.6*y1+195*x2+447.6*y2+190*x3+316.5*y3+8730;
90+x1>=150;
30+19*y1>=450;
x1+x2+60>=150;
19*y1+19*y2-180>=450;
x1+x2+x3+30>=200;
19*y1+19*y2+19*y3-270>=600;
@gin(x1);@gin(y1);@gin(x2);@gin(y2);@gin(x3);@gin(y3);
```
<div style="page-break-after:always;"></div>

生成的最后结果为:

```
 Global optimal solution found.
  Objective value:                              63855.40
  Objective bound:                              63855.40

  Total variables:                      6
  Nonlinear variables:                  0
  Integer variables:                    6

  Total constraints:                    7
  Nonlinear constraints:                0

  Total nonzeros:                      18
  Nonlinear nonzeros:                   0

                                Variable           Value        Reduced Cost
                                      X1        60.00000            200.0000
                                      Y1        23.00000            580.6000
                                      X2        30.00000            195.0000
                                      Y2        11.00000            447.6000
                                      X3        80.00000            190.0000
                                      Y3        12.00000            316.5000

```
由上述结果知，最优飞行计划如下：
| 月份 | 购买新飞机数 | 安排教练 |
| :--: | :----------: | :------------: |
| 1    |      60      |            23  |
| 2    |     30       |          11    |
| 3    |     80       |           12   |

<div style="page-break-after:always;"></div>

### 对于问题二，购买新飞机数和教练的安排数量进行如下假设
| 月份 | 购买新飞机数 | 安排教练的人数 |
| :--: | :----------: | :------------: |
|  1   |    $x_1 $    |     $y_1 $     |
|  2   |    $x_2 $    |     $y_2 $     |
|  3   |    $x_3 $    |     $y_3 $     |

与第一题类似，我们通过上述假设逐个月进行飞行员与飞机数的分析:

#### 第一个月的$y_1$名教练，每名教练带$n_{1n}$名飞行员，

$$
\begin{align}
可用飞机数:&\quad 110\\
\\
可用飞行员数:&\quad 330\\
\\
带薪休假人数:&\quad 0\\
\\
闲置飞行员人数:&\quad 30-y_1\\

\end{align}
$$



#### 第二个月的$y_2$名教练，每名教练带$n_{2n}$名飞行员

$$
\begin{align}
可用飞机数:&\quad90+x_1\\
\\
可用飞行员数:&\quad30+\sum_{y=1}^{y_1}n_{1y}\\
\\
带薪休假人数:&\quad360\\
\\
闲置飞行员人数:&\quad\sum_{y=1}^{y_1}n_{1y}-y_2-420\\

\end{align}
$$

<div style="page-break-after:always;"></div>

#### 第三个月的$y_3 $名教练，每名教练带$n_{3n}$名飞行员

$$
\begin{align}
可用飞机数:&\quad x_1+x_2+60\\
\\
可用飞行员数:&\quad\sum_{y=1}^{y_1}n_{1y}+\sum_{y=1}^{y_2}n_{2y}-180\\
\\
带薪休假人数:&\quad360\\
\\
闲置飞行员人数:&\quad\sum_{y=1}^{y_1}n_{1y}+\sum_{y=1}^{y_2}n_{2y}-y_2-y_3-630\\

\end{align}
$$



#### 第四个月份不需要再请教练和飞行员
$$
\begin{align}
可用飞机数:&\quad x_1+x_2+x_3+30\\
\\
可用飞行员数:&\quad\sum_{y=1}^{y_1}n_{1y}+\sum_{y=1}^{y_2}n_{2y}+\sum_{y=1}^{y_3}n_{3y}-y_2-y_3-270\\
\\
带薪休假人数:&\quad360\\
\\
闲置飞行员人数:&\quad\sum_{y=1}^{y_1}n_{1y}+\sum_{y=1}^{y_2}n_{2y}+\sum_{y=1}^{y_3}n_{3y}-y_2-y_3-870\\

\end{align}
$$




基本模型

决策变量:$x_1,x_2,x_3,y_1,y_2,y_3,n_{1i},n_{2i},n_{3i}​$
$$
Min\quad z=200x_1+195x_2+190x_3-7y_1-20.4y_2-13.5y_3+20.4\sum_{y=1}^{y1}n_{1y}\\
+13.5\sum_{y=1}^{y2}n_{2y}+6.7\sum_{y=1}^{y3}n_{3y}+8730
$$

其中与问题一类似，可以列出如下不等式。
$$
\begin{align}
90+x_1&\geq150\\
\\
30+\sum_{y=1}^{y1}n_{1y}&\geq150\\
\\
x_1+x_2+60&\geq 150\\
\\
\sum_{y=1}^{y1}n_{1y}+\sum_{y=1}^{y2}n_{2y}-y_2-180 &\geq 450\\
x_1+x_2+x_3+30 &\geq200\\
\\
\sum_{y=1}^{y1}n_{1y}+\sum_{y=1}^{y2}n_{2y}+\sum_{y=1}^{y3}n_{3y}-y_2-y_3-270 &\geq 600\\
\\
2 \leq n_{1y} &\leq 20\\
\\
2 \leq n_{2y} &\leq 20\\
\\
2 \leq n_{3y} &\leq 20
\\
设\sum_{y=1}^{y1}n_{1y}，\sum_{y=1}^{y2}n_{2y}，\sum_{y=1}^{y3}n_{3y}&分别为t_1,t_2,t_3\\
\\
此时目标函数为 Min\quad z&=200x_1+195x_2+190x_3+3y_1+3y_2\\
&+3y_3+30.4t_1+23.4t_2+16.53t_3+8730
\end{align}
$$

```lisp
min=200*x1+195*x2+190*x3+30.4*x4+23.4*x5+16.5*x6+3*x7+3*x8+3*x9+8730;
90+x1>=150;
30+x4>=450;
x1+x2+60>=150;
x4+x5-180>=450;
x1+x2+x3+30>=200;
x4+x5+x6-270>=600;
x4<=20*x7;
x5<=20*x8;
x6<=20*x9;
@gin(x1);@gin(x2);@gin(x3);@gin(x4);@gin(x5);@gin(x6);@gin(x7);@gin(x8);@gin(x9);
```

```
  Global optimal solution found.
  Objective value:                              63554.00
  Objective bound:                              63554.00

                                Variable           Value        Reduced Cost
                                      X1        60.00000            200.0000
                                      X2        30.00000            195.0000
                                      X3        80.00000            190.0000
                                      X4        420.0000            30.40000
                                      X5        210.0000            23.40000
                                      X6        240.0000            16.50000
                                      X7        21.00000            3.000000
                                      X8        11.00000            3.000000
                                      X9        12.00000            3.000000

```

此时的最优决策如下

| 月份 | 飞机数量 | 飞行教练数量 | 飞行员数量 |
| ---- | -------- | ------------ | ---------- |
| 1    | 60       | 21           | 420        |
| 2    | 30       | 11           | 210        |
|      | 80       | 12           | 240        |

最少花费为63554元。


## 总结

本问题的核心难点在于对于限制条件的数学量化表达，将本体复杂的题目简化后进行建模，我们发现，问题主要存在四个研究对象即变量：新购买的飞机数，闲置的飞机数量、教授数量与新飞行员数量，有了这四个研究对象，飞行员的选择问题可以抽象成以多个不等式为约束条件的最值表达式，再使用LINGO对其求解则可以得出最优解。
