# Google PageRank数学模型

## 摘要

小组希望通过介绍一个成功并广泛使用的数学模型——Google公司的Page Rank算法，并解析该数学模型的原理。该数学模型使用了图论，概率统计，马尔可夫链等数学工具解释了在Google搜索中网页出现的次序是如何产生的。

PageRank算法的核心思想是

1. 如果一个网页被很多其他网页链接，说明这个网页具有很大参考性
2. 如果一个具有很大参考性的网页有链接指向的其他网页，那么被链接到的网页也同样具有较大的参考系。

## 模型介绍

佩奇排名(PageRank)，又称网页排名，是Google公司所使用的对其搜索引擎搜索结果中的网页进行排名的一种算法。

佩奇排名本质上是一种以网页之间的超链接个数和质量作为主要因素粗略地分析网页的重要性的算法。其基本假设是：更重要的页面往往更多地被其他页面引用。 其将从A页面到B页面的链接比作“A页面

给B页面投票”，并根据投票来源（甚至来源的来源，即链接到A页面的页面）和投票对象的等级来决定被投票页面的等级。简述之就是一个高等级的页面可以提升其他低等级的页面。

算法由谷歌公司创始人之一的拉里·佩奇(Larry Page)的名字來命名。谷歌搜索引擎用它来分析网页的相关性和重要性，在搜索引擎优化中經常被用來作为評估網頁优化的成效因素之一。目前为止，佩奇排名算法不再是谷歌公司用来给网页进行排名的唯一算法，但它是最早的，也是最著名的算法。



## 模型假设
PageRank算法假设输出概率分布能体现某位用户随机点击某个链接的概率。设定一个PR值，其物理意义为一个网页被访问的概率。PR值可以在任何规模文件计算得出，每个链接都指向该集合中的某个特定文件。PR值在区间(0,1)，表示事件发生的概率。



## 符号说明

| 符号            | 解释                                                         |
| --------------- | ------------------------------------------------------------ |
| $PR(x)$         | 表示页面x的PR值                                              |
| $L(x)$          | 页面$x$链出的数量                                            |
| $In(x)$         | 链入$x$页面的集合                                            |
| $N$             | 集合中所有页面的数量                                         |
| $d$             | 阻尼系数，又称修正值                                         |
| $\gamma (x,y) $ | 从页面$x$指向页面$y​$的链接数 与 页面$y​$中含有外部链接总数 的比值 |
| *M*             | 表示页面之间出入概率的矩阵                                   |



## 模型建立

### 模型一

模型A假设有4个网页组成的集合即A,B,C,D四个页面，同一个页面中多个指向相同的链接视为同一个链接，每个页面初始的PR值相同为1。

情况1：当所有页面都只链接至A，如下图，那么$PR(A)$就为$B,C,D$的$PR$值之和，即
$$
PR(A)=PR(B)+PR(C)+PR(D)
$$
情况2：当所有的页面都如下图链接，即B链接倒A和C，C链接倒A，D链接倒A,B,C。
$$
PR(A)= {PR(B)\over 2}+{PR(C)\over 1}+{PR(D)\over 3}
$$
换成j加上修正系数可以变成更通用的形式，当遇上没有外链接的页面，传递出去的PR值为0，如情况1的A页面，会递归地导致指向它的页面PR值得计算结果同样为零。所以对每个页面的PR值，赋一个最小值$(1-d)/ N
$$
PR(A)=  \Bigl({PR(B)\over L(B)}+{PR(C)\over L(C)}+{PR(D)\over L(D)}+\cdots\bigr)\times d+{1-d\over N}
$$

从上述公式看出，一个页面的PR值取决于指向其的其他页面。



### 模型二

对于修正系数的理解，我们也可以假设某人在浏览器随机打开某些页面并点击了某些链接，并不断点击网页上的链接直到进入一个没有外部链接的网页，那此时他会随机浏览其他的网页。为了方便计算，上述公式又可以转化成如下公式：
$$
PR(p_i)=d\times \sum_{p_j \in In(p_i)}{PR(p_j)\over L(p_j)}+{1-d\over N}
$$
所有页面 的PR值可以用向量的形式表示，特征向量为
$$
R=\begin{pmatrix}
PR(p_1)\\PR(p_2)\\PR(p_3)\\\vdots\\PR(p_N)
\end{pmatrix}
$$
使用$\gamma(x,y)$代替原模型链接某个页面x的全职之和
$$
\gamma(x,y)={1\over L(y)}\\
其中当x=y时，\gamma(x,y)=0
$$
于是我们联系线性代数中的矩阵方法，总结出以下求解公式
$$
R=\begin{pmatrix}{1-d\over N}\\{1-d\over N}\\\vdots\\{1-d\over N }\end{pmatrix}+d
\begin{pmatrix}\gamma(p_1,p_1)&\gamma(p_1,p_2)&\cdots&\gamma(p_1,p_n)
\\\gamma(p_2,p_1)&\gamma(p_2,p_2)&\cdots&\gamma(p_2,p_n)
\\\vdots&\vdots&\ddots&\vdots
\\\gamma(p_n,p_1)&\gamma(p_n,p_2)&\cdots&r(p_n,p_n)
\end{pmatrix}R
$$
由于上述修改后的邻接矩阵的巨大的特征值，所以几次迭代后即可在极高的精确度下估计PageRank特征向量R的值。可以得出由于$d<0$，上述求解公式为收敛的马尔可夫链。



## 模型验证

依然以图一作为例子，此时使用继续使用矩阵$M​$表示页面之间出入的关系
$$
M=\begin{pmatrix}\gamma(p_1,p_1)&\gamma(p_1,p_2)&\cdots&\gamma(p_1,p_n)
\\\gamma(p_2,p_1)&\gamma(p_2,p_2)&\cdots&\gamma(p_2,p_n)
\\\vdots&\vdots&\ddots&\vdots
\\\gamma(p_n,p_1)&\gamma(p_n,p_2)&\cdots&r(p_n,p_n)
\end{pmatrix}=\begin{pmatrix}0&1/2&0&0\\
1/3&0&0&1/2\\
1/3&0&1&1/2\\
1/3&1/2&0&0
\end{pmatrix}
$$
设 *e​* 为分量全部为1的列向量，定义矩阵 *A*：
$$
A=dM+{(1-d)\over N}ee^T\\
有R_{n+1}=AR_n
$$
由于这个马尔可夫过程收敛，且有$\lim_{n \rightarrow \infty}R_{n}$存在，与初始值$R_0$的选取无关，由于状态转移矩阵A满足

1. A为随机矩阵，因为$\forall_{i=1...n} \sum_{j=1}^{n}A_{ij}=1 $
2. A为不可约矩阵 ，因为A对应的有向图是强连通的。其中无链接通入的网页也有概率通过输入网址进行访问。
3. A为非周期矩阵

由上面三个原因证明了PageRank算法的正确性。



## 模型PR值计算方法

### 4.1 幂迭代法

首先给每个页面赋予随机的PR值，然后通过$R_{n+1}=AR_{n}​$不断地迭代PR值。当满足下面的不等式后迭代结束，获得所有页面的PR值：
$$
|P_{n+1}-P_n|<\lambda
$$

### 4.2 特征值法

当马尔可夫链收敛的时候，必有
$$
P=AP \Rightarrow P为矩阵A特征值1对应的特征向量
$$

### 4.3 代数法

相似的，当马尔可夫链收敛时，必有
$$
R = A R \\
\Rightarrow R = \lgroup d S + \frac{(1 - d)}{N}ee^T \rgroup R \\
\because e为所有分量都为 1 的列向量，R的所有分量之和为1 \\
\Rightarrow R = d SR + \frac{(1 - d)}{N}e \\
\Rightarrow (ee^T - d S)R = \frac{(1 - \alpha)}{N}e \\
\Rightarrow R = (ee^T - d S)^{-1} \frac{(1-d)}{N}e \\
$$


## 模型缺陷




## 总结

